
  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v2.4.1)

2021-11-24 15:41:41 [background-preinit] INFO  o.h.validator.internal.util.Version - HV000001: Hibernate Validator 6.1.6.Final
2021-11-24 15:41:41 [main] INFO  j.c.misumi.billing.batch.Application - Starting Application using Java 11.0.3 on SZ-GADZ051006 with PID 5300 (E:\pleiades\workspace\billing-service-develop\billing-batch\build\libs\billing-batch-1.0.0-SNAPSHOT.jar started by zhuss in D:\pleiades\workspace\rakuraku-auto-test)
2021-11-24 15:41:41 [main] INFO  j.c.misumi.billing.batch.Application - No active profile set, falling back to default profiles: default
2021-11-24 15:41:43 [main] WARN  o.m.s.mapper.ClassPathMapperScanner - Skipping MapperFactoryBean with name 'producedEventPartitionResolver' and 'jp.co.misumi.fw.event.api.producer.client.database.store.mybatis.ProducedEventPartitionResolver' mapperInterface. Bean already defined with the same name!
2021-11-24 15:41:43 [main] WARN  o.m.s.mapper.ClassPathMapperScanner - Skipping MapperFactoryBean with name 'producedEventTableNameResolver' and 'jp.co.misumi.fw.event.api.producer.client.database.store.mybatis.ProducedEventTableNameResolver' mapperInterface. Bean already defined with the same name!
2021-11-24 15:41:45 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat initialized with port(s): 8080 (http)
2021-11-24 15:41:45 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Initializing ProtocolHandler ["http-nio-8080"]
2021-11-24 15:41:45 [main] INFO  o.a.catalina.core.StandardService - Starting service [Tomcat]
2021-11-24 15:41:45 [main] INFO  o.a.catalina.core.StandardEngine - Starting Servlet engine: [Apache Tomcat/9.0.41]
2021-11-24 15:41:45 [main] INFO  o.a.c.c.C.[Tomcat].[localhost].[/] - Initializing Spring embedded WebApplicationContext
2021-11-24 15:41:45 [main] INFO  o.s.b.w.s.c.ServletWebServerApplicationContext - Root WebApplicationContext: initialization completed in 4235 ms
Logging initialized using 'class org.apache.ibatis.logging.stdout.StdOutImpl' adapter.
Registered type handler: 'class java.time.ZonedDateTime'
Property 'mapperLocations' was not specified.
2021-11-24 15:41:50 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor - Initializing ExecutorService 'applicationTaskExecutor'
2021-11-24 15:41:50 [main] INFO  o.s.b.a.s.s.UserDetailsServiceAutoConfiguration - 

Using generated security password: b044974d-e3fd-4f1b-881c-466c77b82039

2021-11-24 15:41:51 [main] INFO  o.s.s.web.DefaultSecurityFilterChain - Will secure any request with [org.springframework.security.web.context.request.async.WebAsyncManagerIntegrationFilter@77b6ceb7, org.springframework.security.web.context.SecurityContextPersistenceFilter@6a339bc3, org.springframework.security.web.header.HeaderWriterFilter@23cfbf76, org.springframework.security.web.csrf.CsrfFilter@38a45856, org.springframework.security.web.authentication.logout.LogoutFilter@332b503, org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter@1721de56, org.springframework.security.web.authentication.ui.DefaultLoginPageGeneratingFilter@2e48a09d, org.springframework.security.web.authentication.ui.DefaultLogoutPageGeneratingFilter@741cade9, org.springframework.security.web.authentication.www.BasicAuthenticationFilter@31d54672, org.springframework.security.web.savedrequest.RequestCacheAwareFilter@423b1d07, org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter@44649369, org.springframework.security.web.authentication.AnonymousAuthenticationFilter@48837722, org.springframework.security.web.session.SessionManagementFilter@376bf138, org.springframework.security.web.access.ExceptionTranslationFilter@1d28d2e, org.springframework.security.web.access.intercept.FilterSecurityInterceptor@252618e4]
2021-11-24 15:41:51 [main] INFO  o.s.b.a.e.web.EndpointLinksResolver - Exposing 2 endpoint(s) beneath base path '/actuator'
2021-11-24 15:41:51 [main] INFO  o.a.coyote.http11.Http11NioProtocol - Starting ProtocolHandler ["http-nio-8080"]
2021-11-24 15:41:51 [main] INFO  o.s.b.w.e.tomcat.TomcatWebServer - Tomcat started on port(s): 8080 (http) with context path ''
2021-11-24 15:41:51 [main] INFO  j.c.misumi.billing.batch.Application - Started Application in 12.163 seconds (JVM running for 13.426)
2021-11-24 15:41:51 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Starting...
2021-11-24 15:41:51 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Start completed.
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
JDBC Connection [HikariProxyConnection@1757028433 wrapping org.postgresql.jdbc.PgConnection@47108312] will be managed by Spring
==>  Preparing: SELECT m1.subsidiary_code as subsidiaryCode , m1.ginner_code as ginnerCode , m1.plant_code as plantCode , m1.po_qty as poQty , m1.automatic_po_type as automaticPoType , m2.total_stock_qty as totalStockQty , m2.total_allocate_qty as totalAllocateQty , m2.total_available_qty as totalAvailableQty , m2.current_stock_qty as currentStockQty , m1.reorder_point as reorderPoint , m1.rank as rank , m2.evaluation_unit_price as evaluationUnitPrice , m2.month_begin_stock_qty as monthBeginStockQty , t1.latest_receiving_date as latestReceivingDate , t1.latest_receiving_qty as latestReceivingQty , t1.this_month_shipment_qty as thisMonthShipmentQty , t1.this_year_month_shipping_qty1 as thisYearMonthShippingQty1 , t1.this_year_month_shipping_qty2 as thisYearMonthShippingQty2 , t1.this_year_month_shipping_qty3 as thisYearMonthShippingQty3 , t1.this_year_month_shipping_qty4 as thisYearMonthShippingQty4 , t1.this_year_month_shipping_qty5 as thisYearMonthShippingQty5 , t1.this_year_month_shipping_qty6 as thisYearMonthShippingQty6 , t1.this_year_month_shipping_qty7 as thisYearMonthShippingQty7 , t1.this_year_month_shipping_qty8 as thisYearMonthShippingQty8 , t1.this_year_month_shipping_qty9 as thisYearMonthShippingQty9 , t1.this_year_month_shipping_qty10 as thisYearMonthShippingQty10 , t1.this_year_month_shipping_qty11 as thisYearMonthShippingQty11 , t1.this_year_month_shipping_qty12 as thisYearMonthShippingQty12 , t1.last_year_month_shipping_qty1 as lastYearMonthShippingQty1 , t1.last_year_month_shipping_qty2 as lastYearMonthShippingQty2 , t1.last_year_month_shipping_qty3 as lastYearMonthShippingQty3 , t1.last_year_month_shipping_qty4 as lastYearMonthShippingQty4 , t1.last_year_month_shipping_qty5 as lastYearMonthShippingQty5 , t1.last_year_month_shipping_qty6 as lastYearMonthShippingQty6 , t1.last_year_month_shipping_qty7 as lastYearMonthShippingQty7 , t1.last_year_month_shipping_qty8 as lastYearMonthShippingQty8 , t1.last_year_month_shipping_qty9 as lastYearMonthShippingQty9 , t1.last_year_month_shipping_qty10 as lastYearMonthShippingQty10 , t1.last_year_month_shipping_qty11 as lastYearMonthShippingQty11 , t1.last_year_month_shipping_qty12 as lastYearMonthShippingQty12 , m3.product_code as productCode , m7.po_lead_time as poLeadTime , m7.supplier_code as supplierCode , m6.classify_code as classifyCode FROM m_stock_setting m1 LEFT JOIN t_stock_status m2 ON (m1.subsidiary_code = m2.subsidiary_code AND m1.ginner_code = m2.ginner_code AND m1.plant_code = m2.plant_code ) LEFT JOIN t_receiving_and_shipment_accumulation t1 ON (m1.subsidiary_code = t1.subsidiary_code AND m1.ginner_code = t1.ginner_code AND m1.plant_code = t1.plant_code) JOIN m_product m3 ON (m1.subsidiary_code = m3.subsidiary_code AND m1.ginner_code = m3.ginner_code ) JOIN m_plant m4 ON m1.plant_code = m4.plant_code JOIN m_ginner_info m5 ON (m1.ginner_code = m5.ginner_code AND m1.subsidiary_code = m5.subsidiary_code ) JOIN m_type_code m6 ON m6.type_code = left(m5.inner_code, 7) JOIN (SELECT t.subsidiary_code , t.ginner_code , t.supplier_choice_area_code , t.product_supplier_type , t.supplier_code , t.po_lead_time FROM (SELECT ROW_NUMBER() OVER (PARTITION BY subsidiary_code, ginner_code, supplier_choice_area_code, product_supplier_type ORDER BY subsidiary_code, ginner_code, supplier_choice_area_code, product_supplier_type) rowid , subsidiary_code , ginner_code , supplier_choice_area_code , product_supplier_type , supplier_code , po_lead_time FROM m_product_supplier ) t WHERE t.rowid = 1 ) m7 ON (m3.subsidiary_code = m7.subsidiary_code AND m3.ginner_code = m7.ginner_code ) WHERE m1.subsidiary_code = ? AND ( ( m3.supplier_specify_method_type = '0' AND m7.supplier_choice_area_code = '999' AND m7.product_supplier_type = '1' ) OR ( m3.supplier_specify_method_type = '1' AND m7.supplier_choice_area_code = m4.supplier_choice_area_code AND m7.product_supplier_type = '4' ) )
==> Parameters: CHN(String)
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Transaction synchronization suspending SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5753d994]
JDBC Connection [HikariProxyConnection@707922875 wrapping org.postgresql.jdbc.PgConnection@14611af1] will be managed by Spring
==>  Preparing: DELETE FROM t_dead_stock_classify
==> Parameters: 
<==    Updates: 1
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5753d994]
Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5753d994]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5753d994]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5753d994]
Transaction synchronization resuming SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
<==    Columns: subsidiarycode, ginnercode, plantcode, poqty, automaticpotype, totalstockqty, totalallocateqty, totalavailableqty, currentstockqty, reorderpoint, rank, evaluationunitprice, monthbeginstockqty, latestreceivingdate, latestreceivingqty, thismonthshipmentqty, thisyearmonthshippingqty1, thisyearmonthshippingqty2, thisyearmonthshippingqty3, thisyearmonthshippingqty4, thisyearmonthshippingqty5, thisyearmonthshippingqty6, thisyearmonthshippingqty7, thisyearmonthshippingqty8, thisyearmonthshippingqty9, thisyearmonthshippingqty10, thisyearmonthshippingqty11, thisyearmonthshippingqty12, lastyearmonthshippingqty1, lastyearmonthshippingqty2, lastyearmonthshippingqty3, lastyearmonthshippingqty4, lastyearmonthshippingqty5, lastyearmonthshippingqty6, lastyearmonthshippingqty7, lastyearmonthshippingqty8, lastyearmonthshippingqty9, lastyearmonthshippingqty10, lastyearmonthshippingqty11, lastyearmonthshippingqty12, productcode, poleadtime, suppliercode, classifycode
<==        Row: CHN, MDM00000000001, P001, 5465, 1, 99999, 999, 4, 9999, 3, 2, 99.000, 5, 2020-08-25, 53268, 95623, 11, 21, 31, 41, 51, 61, 71, 81, 91, 101, 111, 121, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, product001, 123, sc01, 01afy001
<==      Total: 1
Transaction synchronization suspending SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@42aeb6b]
JDBC Connection [HikariProxyConnection@1709438474 wrapping org.postgresql.jdbc.PgConnection@14611af1] will be managed by Spring
==>  Preparing: INSERT INTO T_DEAD_STOCK_CLASSIFY( subsidiary_code, market_code, plant_code, ginner_code, product_code, current_stock_qty, remain_po, rank, automatic_po_type, reorder_point, po_qty, po_lead_time, supplier_code, evaluation_unit_price, shipment_qty_this_month, shipment_qty_last_month, latest_receiving_date, latest_receiving_qty, total_stock_qty, current_allocated_qty, shipping_qty_this_month, shipping_qty_last_month, shipping_qty_2months_before, shipping_qty_3months_before, shipping_qty_4months_before, shipping_qty_5months_before, shipping_qty_6months_before, shipping_qty_7months_before, shipping_qty_8months_before, shipping_qty_9months_before, shipping_qty_10months_before, shipping_qty_11months_before, update_count, delete_flag, register_user_type, register_user, register_date_time, register_program, register_client_program, update_user_type, update_user, update_date_time, update_program, update_client_program )values( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
==> Parameters: CHN(String), 01(String), P001(String), MDM00000000001(String), product001(String), 9999(BigDecimal), 90000.000(BigDecimal), 2(String), 1(String), 3.000(BigDecimal), 5465.000(BigDecimal), 123.000(BigDecimal), sc01(String), 99.000(BigDecimal), 95623(BigDecimal), 12(BigDecimal), 2020-08-25(LocalDate), 53268.000(BigDecimal), 99999.000(BigDecimal), null, 11(BigDecimal), 12(BigDecimal), 11(BigDecimal), 10(BigDecimal), 9(BigDecimal), 8(BigDecimal), 7(BigDecimal), 6(BigDecimal), 5(BigDecimal), 4(BigDecimal), 3(BigDecimal), 2(BigDecimal), 0(Integer), 0(String), Batch(String), MBSAR30010(String), 2021-11-24T16:41:52.186725200+09:00(OffsetDateTime), MBSAR30010(String), MBSAR30010(String), Batch(String), MBSAR30010(String), 2021-11-24T16:41:52.186725200+09:00(OffsetDateTime), MBSAR30010(String), MBSAR30010(String)
<==    Updates: 1
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@42aeb6b]
Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@42aeb6b]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@42aeb6b]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@42aeb6b]
Transaction synchronization resuming SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Transaction synchronization suspending SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2d51716d]
JDBC Connection [HikariProxyConnection@1229485258 wrapping org.postgresql.jdbc.PgConnection@14611af1] will be managed by Spring
==>  Preparing: DELETE FROM T_PLANT_PRODUCT_SHIPPING_AMOUNT WHERE subsidiary_code = ? AND year_month = LEFT(?, 6)
==> Parameters: CHN(String), 20210101(String)
<==    Updates: 0
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2d51716d]
Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2d51716d]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2d51716d]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2d51716d]
Transaction synchronization resuming SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be] from current transaction
==>  Preparing: SELECT t1.subsidiary_code as subsidiaryCode , t1.plant_code as plantCode , t1.ginner_code as ginnerCode , t1.product_code as productCode , t1.current_stock_qty as currentStockQty , t1.remain_po as remainPo , t1.rank as rank , t1.automatic_po_type as automaticPoType , t1.reorder_point as reorderPoint , t1.po_qty as poQty , t1.po_lead_time as poLeadTime , t1.supplier_code as supplierCode , t1.evaluation_unit_price as evaluationUnitPrice , t1.shipment_qty_this_month as shipmentQtyThisMonth , t1.shipment_qty_last_month as shipmentQtyLastMonth , t1.latest_receiving_date as latestReceivingDate , t1.latest_receiving_qty as latestReceivingQty , t1.total_stock_qty as totalStockQty , t1.current_allocated_qty as currentAllocatedQty , t1.shipping_qty_this_month as shippingQtyThisMonth , t1.shipping_qty_last_month as shippingQtyLastMonth , t1.shipping_qty_2months_before as shippingQty2MonthsBefore , t1.shipping_qty_3months_before as shippingQty3MonthsBefore , t1.shipping_qty_4months_before as shippingQty4MonthsBefore , t1.shipping_qty_5months_before as shippingQty5MonthsBefore , t1.shipping_qty_6months_before as shippingQty6MonthsBefore , t1.shipping_qty_7months_before as shippingQty7MonthsBefore , t1.shipping_qty_8months_before as shippingQty8MonthsBefore , t1.shipping_qty_9months_before as shippingQty9MonthsBefore , t1.shipping_qty_10months_before as shippingQty10MonthsBefore , t1.shipping_qty_11months_before as shippingQty11MonthsBefore , m1.product_control_department_code as productControlDepartmentCode , m1.release_date as releaseDate , m1.developed_date as developedDate , m2.product_control_department_name as productControlDepartmentName , m4.classify_code as classifyCode FROM t_dead_stock_classify t1 JOIN m_product m1 ON (t1.subsidiary_code = m1.subsidiary_code AND t1.ginner_code = m1.ginner_code ) JOIN m_product_control_department m2 ON (m1.product_control_department_code = m2.product_control_department_code ) JOIN m_ginner_info m3 ON (t1.ginner_code = m3.ginner_code AND t1.subsidiary_code = m3.subsidiary_code) JOIN m_type_code m4 ON (left(m3.inner_code, 7) = m4.type_code ) WHERE t1.subsidiary_code = ?
==> Parameters: CHN(String)
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
<==    Columns: subsidiarycode, plantcode, ginnercode, productcode, currentstockqty, remainpo, rank, automaticpotype, reorderpoint, poqty, poleadtime, suppliercode, evaluationunitprice, shipmentqtythismonth, shipmentqtylastmonth, latestreceivingdate, latestreceivingqty, totalstockqty, currentallocatedqty, shippingqtythismonth, shippingqtylastmonth, shippingqty2monthsbefore, shippingqty3monthsbefore, shippingqty4monthsbefore, shippingqty5monthsbefore, shippingqty6monthsbefore, shippingqty7monthsbefore, shippingqty8monthsbefore, shippingqty9monthsbefore, shippingqty10monthsbefore, shippingqty11monthsbefore, productcontroldepartmentcode, releasedate, developeddate, productcontroldepartmentname, classifycode
<==        Row: CHN, P001, MDM00000000001, product001, 9999, 90000, 2, 1, 3, 5465, 123, sc01, 99.000, 95623, 12, 2020-08-25, 53268, 99999, null, 11, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, pcdc01, 2021-02-01, 2021-10-11, è§ïièää«ïîñÂñº1, 01afy001
<==      Total: 1
Transaction synchronization suspending SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b428742]
JDBC Connection [HikariProxyConnection@1891841301 wrapping org.postgresql.jdbc.PgConnection@14611af1] will be managed by Spring
==>  Preparing: INSERT INTO T_PLANT_PRODUCT_SHIPPING_AMOUNT( subsidiary_code, year_month, plant_code, ginner_code, per_year_shipping_qty, average_shipping_qty_per_month, average_shipping_qty_per_date, po_lead_time_sales_qty, release_year_month, developed_year_month, year_month_type, year_month_type_name, classify_code, market_classify_code, product_code, product_control_department_code, product_control_department_name_native, current_stock_qty, reorder_point, surplus_stock_qty, po_qty, remain_po, allocated_qty, rank, automatic_po_type, po_lead_time, supplier_code, evaluation_unit_price, latest_receiving_date, latest_receiving_qty, total_stock_qty, year_shipping_amount, average_shipping_amount_month, current_stock_amount, reorder_point_amount, surplus_stock_amount, last_month_shipment_amount, this_month_shipment_amount, total_stock_amount, variable0, variable1, variable2, variable3, variable4, variable5, variable6, variable7, variable8, variable9, variable10, variable11, variable12, variable13, variable14, variable15, variable16, variable17, variable18, variable19, variable20, variable21, variable22, variable23, variable24, variable25, variable26, variable27, variable28, variable29, variable30, variable31, consumption_no_expected_stock_amount, dead_stock_threshold, update_count, delete_flag, register_user_type, register_user, register_date_time, register_program, register_client_program, update_user_type, update_user, update_date_time, update_program, update_client_program )values( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
==> Parameters: CHN(String), 202101(String), P001(String), MDM00000000001(String), 88.000(BigDecimal), 9.778(BigDecimal), 0.444(BigDecimal), 54.612000(BigDecimal), 202102(String), 202110(String), 005(String), ÇUÉñåéÅ|ÇPîN(String), 01afy001(String), 01af(String), product001(String), pcdc01(String), è§ïièää«ïîñÂñº1(String), 9999.000(BigDecimal), 3.000(BigDecimal), 9996.000(BigDecimal), 5465.000(BigDecimal), 90000.000(BigDecimal), null, 2(String), 1(String), 123.000(BigDecimal), sc01(String), 99.000(BigDecimal), 2020-08-25(LocalDate), 53268.000(BigDecimal), 99999.000(BigDecimal), 8712.000000(BigDecimal), 968.022000(BigDecimal), 989901.000(BigDecimal), 297.000(BigDecimal), 989604.000(BigDecimal), 1188.000(BigDecimal), 9466677.000(BigDecimal), 9899901.000(BigDecimal), 297.000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 968.022000(BigDecimal), 960563.390(BigDecimal), 0.000(BigDecimal), 1022.295(BigDecimal), 0(Integer), 0(String), Batch(String), MBSAR30010(String), 2021-11-24T16:41:52.244723600+09:00(OffsetDateTime), MBSAR30010(String), MBSAR30010(String), Batch(String), MBSAR30010(String), 2021-11-24T16:41:52.244723600+09:00(OffsetDateTime), MBSAR30010(String), MBSAR30010(String)
<==    Updates: 1
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b428742]
Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b428742]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b428742]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5b428742]
Transaction synchronization resuming SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Transaction synchronization suspending SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e9157ff]
JDBC Connection [HikariProxyConnection@1134133898 wrapping org.postgresql.jdbc.PgConnection@14611af1] will be managed by Spring
==>  Preparing: DELETE FROM T_PRODUCT_SHIPPING_AMOUNT WHERE subsidiary_code = ? AND year_month = LEFT(?, 6)
==> Parameters: CHN(String), 20210101(String)
<==    Updates: 0
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e9157ff]
Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e9157ff]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e9157ff]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@5e9157ff]
Transaction synchronization resuming SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Fetched SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be] from current transaction
==>  Preparing: SELECT t1.subsidiary_code as subsidiaryCode , t1.release_year_month as releaseYearMonth , t1.developed_year_month as developedYearMonth , t1.year_month_type as yearMonthType , t1.year_month_type_name as yearMonthTypeName , t1.classify_code as classifyCode , t1.market_classify_code as marketClassifyCode , t1.ginner_code as ginnerCode , t1.product_control_department_code as productControlDepartmentCode , t1.product_control_department_name_native as productControlDepartmentNameNative , max(t1.product_code) as productCode , sum(t1.per_year_shipping_qty) as perYearShippingQtySum , sum(t1.average_shipping_qty_per_month) as averageShippingQtyPerMonthSum , sum(t1.average_shipping_qty_per_date) as averageShippingQtyPerDateSum , sum(t1.po_lead_time_sales_qty) as poLeadTimeSalesQtySum , sum(t1.current_stock_qty) as currentStockQtySum , sum(t1.reorder_point) as reorderPointSum , sum(t1.surplus_stock_qty) as surplusStockQtySum , sum(t1.po_qty) as poQtySum , sum(t1.remain_po) as remainPoSum , sum(t1.allocated_qty) as allocatedQtySum , sum(t1.latest_receiving_qty) as latestReceivingQtySum , sum(t1.total_stock_qty) as totalStockQtySum , sum(t1.year_shipping_amount) as yearShippingAmountSum , sum(t1.average_shipping_amount_month) as averageShippingAmountMonthSum , sum(t1.current_stock_amount) as currentStockAmountSum , sum(t1.reorder_point_amount) as reorderPointAmountSum , sum(t1.surplus_stock_amount) as surplusStockAmountSum , sum(t1.last_month_shipment_amount) as lastMonthShipmentAmountSum , sum(t1.this_month_shipment_amount) as thisMonthShipmentAmountSum , sum(t1.total_stock_amount) as totalStockAmountSum FROM t_plant_product_shipping_amount t1 WHERE t1.year_month = left(?, 6) AND t1.subsidiary_code = ? GROUP BY t1.subsidiary_code , t1.release_year_month , t1.developed_year_month , t1.year_month_type , t1.year_month_type_name , t1.classify_code , t1.market_classify_code , t1.ginner_code , t1.product_control_department_code , t1.product_control_department_name_native
==> Parameters: 20210101(String), CHN(String)
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
<==    Columns: subsidiarycode, releaseyearmonth, developedyearmonth, yearmonthtype, yearmonthtypename, classifycode, marketclassifycode, ginnercode, productcontroldepartmentcode, productcontroldepartmentnamenative, productcode, peryearshippingqtysum, averageshippingqtypermonthsum, averageshippingqtyperdatesum, poleadtimesalesqtysum, currentstockqtysum, reorderpointsum, surplusstockqtysum, poqtysum, remainposum, allocatedqtysum, latestreceivingqtysum, totalstockqtysum, yearshippingamountsum, averageshippingamountmonthsum, currentstockamountsum, reorderpointamountsum, surplusstockamountsum, lastmonthshipmentamountsum, thismonthshipmentamountsum, totalstockamountsum
<==        Row: CHN, 202102, 202110, 005, ÇUÉñåéÅ|ÇPîN, 01afy001, 01af, MDM00000000001, pcdc01, è§ïièää«ïîñÂñº1, product001, 88.000, 9.778, 0.444, 54.612, 9999, 3, 9996, 5465, 90000, null, 53268, 99999, 8712.000, 968.022, 989901.000, 297.000, 989604.000, 1188.000, 9466677.000, 9899901.000
<==      Total: 1
Transaction synchronization suspending SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2743432c]
JDBC Connection [HikariProxyConnection@603640617 wrapping org.postgresql.jdbc.PgConnection@14611af1] will be managed by Spring
==>  Preparing: INSERT INTO T_PRODUCT_SHIPPING_AMOUNT( subsidiary_code, year_month, ginner_code, per_year_shipping_qty, average_shipping_qty_per_month, average_shipping_qty_per_date, po_lead_time_sales_qty, release_year_month, developed_year_month, year_month_type, year_month_type_name, classify_code, market_classify_code, plant_code, product_code, product_control_department_code, product_control_department_name_native, current_stock_qty, reorder_point, surplus_stock_qty, po_qty, remain_po, allocated_qty, rank, automatic_po_type, po_lead_time, supplier_code, evaluation_unit_price, latest_receiving_date, latest_receiving_qty, total_stock_qty, year_shipping_amount, average_shipping_amount_month, current_stock_amount, reorder_point_amount, surplus_stock_amount, last_month_shipment_amount, this_month_shipment_amount, total_stock_amount, variable0, variable1, variable2, variable3, variable4, variable5, variable6, variable7, variable8, variable9, variable10, variable11, variable12, variable13, variable14, variable15, variable16, variable17, variable18, variable19, variable20, variable21, variable22, variable23, variable24, variable25, variable26, variable27, variable28, variable29, variable30, variable31, consumption_no_expected_stock_amount, dead_stock_threshold, update_count, delete_flag, register_user_type, register_user, register_date_time, register_program, register_client_program, update_user_type, update_user, update_date_time, update_program, update_client_program )values( ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)
==> Parameters: CHN(String), 202101(String), MDM00000000001(String), 88.000(BigDecimal), 9.778(BigDecimal), 0.444(BigDecimal), 54.612(BigDecimal), 202102(String), 202110(String), 005(String), ÇUÉñåéÅ|ÇPîN(String), 01afy001(String), 01af(String), null, product001(String), pcdc01(String), è§ïièää«ïîñÂñº1(String), 9999(BigDecimal), 3(BigDecimal), 9996(BigDecimal), 5465(BigDecimal), 90000(BigDecimal), null, null, null, null, null, null, null, 53268(BigDecimal), 99999(BigDecimal), 8712.000(BigDecimal), 968.022(BigDecimal), 989901.000(BigDecimal), 297.000(BigDecimal), 989604.000(BigDecimal), 1188.000(BigDecimal), 9466677.000(BigDecimal), 9899901.000(BigDecimal), 297.000(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 968.022(BigDecimal), 960563.390(BigDecimal), 0.000(BigDecimal), 1022.295(BigDecimal), 0(Integer), 0(String), Batch(String), MBSAR30010(String), 2021-11-24T16:41:52.291764700+09:00(OffsetDateTime), MBSAR30010(String), MBSAR30010(String), Batch(String), MBSAR30010(String), 2021-11-24T16:41:52.291764700+09:00(OffsetDateTime), MBSAR30010(String), MBSAR30010(String)
<==    Updates: 1
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2743432c]
Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2743432c]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2743432c]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@2743432c]
Transaction synchronization resuming SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Transaction synchronization suspending SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b844e86]
JDBC Connection [HikariProxyConnection@1353015984 wrapping org.postgresql.jdbc.PgConnection@14611af1] will be managed by Spring
==>  Preparing: DELETE FROM T_PRODUCT_DEAD_STOCK_AMOUNT WHERE subsidiary_code = ? AND year_month = LEFT(?, 6)
==> Parameters: CHN(String), 20210101(String)
<==    Updates: 0
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b844e86]
Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b844e86]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b844e86]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4b844e86]
Transaction synchronization resuming SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Transaction synchronization suspending SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Creating a new SqlSession
Registering transaction synchronization for SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25339016]
JDBC Connection [HikariProxyConnection@600961490 wrapping org.postgresql.jdbc.PgConnection@14611af1] will be managed by Spring
==>  Preparing: INSERT INTO T_PRODUCT_DEAD_STOCK_AMOUNT( subsidiary_code , year_month , ginner_code , classify_group_number , business_unit_name , market_classify_code , team_name , market_name , plant_code, classify_code , product_code , inner_product_code , inner_product_info , product_control_department_code , product_control_department_name_native , reorder_point , reorder_point_amount , po_lead_time , po_lot , evaluation_unit_price , release_year_month , year_month_type , year_month_type_name , elapsed_year_month , per_year_shipping_qty , year_shipping_amount , current_stock_amount , dead_stock_amount , risk_stock_amount , current_stock_qty , update_count , delete_flag , register_user_type , register_user , register_date_time , register_program , register_client_program, update_user_type, update_user , update_date_time , update_program , update_client_program ) SELECT s.subsidiary_code , s.year_month , s.ginner_code , s.classify_group_number , s.business_unit_name , s.market_classify_code , s.team_name , COALESCE(s.market_classify_code, '') || '_' || COALESCE(s.team_name, '') as market_name , null, s.classify_code , s.product_code , COALESCE(s.ginner_code, '') || '_' || COALESCE(s.product_code, '') as inner_product_code , COALESCE(s.ginner_code, '') || '_' || COALESCE(s.product_code, '') || '(' || COALESCE(s.reorder_point, 0) || '_' || COALESCE(s.po_lot, 0) || ')' as inner_product_info , s.product_control_department_code , s.product_control_department_name_native , s.reorder_point , s.reorder_point_amount , s.po_lead_time , s.po_lot , s.evaluation_unit_price , s.release_year_month , s.year_month_type , s.year_month_type_name , CASE WHEN COALESCE(s.year_month_type, '') = '' AND COALESCE(s.year_month_type_name, '') = '' THEN '' ELSE COALESCE(s.year_month_type, '') || '_' || COALESCE(s.year_month_type_name, '') END as elapsed_year_month , s.per_year_shipping_qty , s.year_shipping_amount , s.current_stock_amount , s.dead_stock_amount , s.risk_stock_amount , s.current_stock_qty , 0 , '0' , ? , ? , ? , ? , ? , ? , ? , ? , ? , ? FROM (SELECT t1.subsidiary_code , left(?, 6) AS year_month , t1.ginner_code , m3.classify_group_number , m2.business_unit_name , CASE WHEN LEFT(t1.classify_code, 2) IN ('01', '02', '03', '05', '06', '10', '21', '22', '23') THEN LEFT(t1.classify_code, 4) ELSE LEFT(t1.classify_code, 2) END AS market_classify_code , m3.team_name , t1.classify_code , t1.product_code , t1.product_control_department_code , t1.product_control_department_name_native , t1.reorder_point , t1.reorder_point_amount , t1.po_lead_time , t1.po_qty AS po_lot , t1.evaluation_unit_price , t1.release_year_month , t1.year_month_type , t1.year_month_type_name , t1.per_year_shipping_qty , t1.year_shipping_amount , t1.current_stock_amount , CASE WHEN t1.year_month_type IN ('000', '001', '005', '010', '020', '030', '040', '') OR t1.year_month_type IS NULL OR (m1.subsidiary_code IS NOT NULL AND m1.ginner_code IS NOT NULL) THEN 0 ELSE ROUND( COALESCE(t1.variable13, 0) + COALESCE(t1.variable14, 0) + COALESCE(t1.variable15, 0) + COALESCE(t1.variable16, 0) + COALESCE(t1.variable17, 0) + COALESCE(t1.variable18, 0) + COALESCE(t1.variable19, 0) + COALESCE(t1.variable20, 0) + COALESCE(t1.variable21, 0) + COALESCE(t1.variable22, 0) + COALESCE(t1.variable23, 0) + COALESCE(t1.variable24, 0) + COALESCE(t1.variable25, 0) + COALESCE(t1.variable26, 0) + COALESCE(t1.variable27, 0) + COALESCE(t1.variable28, 0) + COALESCE(t1.variable29, 0) + COALESCE(t1.variable30, 0) + COALESCE(t1.variable31, 0) + COALESCE(t1.consumption_no_expected_stock_amount, 0), 0 ) END AS dead_stock_amount , CASE WHEN t1.year_month_type NOT IN ('005', '010', '020', '030', '040') OR t1.year_month_type IS NULL OR m1.ginner_code IS NOT NULL THEN 0 ELSE ROUND( COALESCE(t1.variable13, 0) + COALESCE(t1.variable14, 0) + COALESCE(t1.variable15, 0) + COALESCE(t1.variable16, 0) + COALESCE(t1.variable17, 0) + COALESCE(t1.variable18, 0) + COALESCE(t1.variable19, 0) + COALESCE(t1.variable20, 0) + COALESCE(t1.variable21, 0) + COALESCE(t1.variable22, 0) + COALESCE(t1.variable23, 0) + COALESCE(t1.variable24, 0) + COALESCE(t1.variable25, 0) + COALESCE(t1.variable26, 0) + COALESCE(t1.variable27, 0) + COALESCE(t1.variable28, 0) + COALESCE(t1.variable29, 0) + COALESCE(t1.variable30, 0) + COALESCE(t1.variable31, 0) + COALESCE(t1.consumption_no_expected_stock_amount, 0), 0 ) END AS risk_stock_amount , t1.current_stock_qty FROM t_product_shipping_amount t1 LEFT JOIN m_dead_stock_exclude_product m1 ON (t1.subsidiary_code = m1.subsidiary_code AND t1.ginner_code = m1.ginner_code AND m1.delete_flag = '0') JOIN m_dead_stock_business_unit m2 ON (LEFT(t1.classify_code, 2) = m2.business_unit_code) JOIN m_dead_stock_team m3 ON (LEFT(t1.classify_code, 2) = m3.business_unit_code) WHERE t1.year_month = left(?, 6) AND t1.subsidiary_code = ? AND ( ( LEFT(t1.classify_code, 2) IN ('01', '02', '03', '05', '06', '10', '21', '22', '23') AND m3.team_code = SUBSTRING(t1.classify_code, 3, 2)) OR ( LEFT(t1.classify_code, 2) NOT IN ('01', '02', '03', '05', '06', '10', '21', '22', '23')) ) ) s
==> Parameters: Batch(String), MBSAR30010(String), 2021-11-24T16:41:52.327754800+09:00(OffsetDateTime), MBSAR30010(String), MBSAR30010(String), Batch(String), MBSAR30010(String), 2021-11-24T16:41:52.327754800+09:00(OffsetDateTime), MBSAR30010(String), MBSAR30010(String), 20210101(String), 20210101(String), CHN(String)
<==    Updates: 0
Releasing transactional SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25339016]
Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25339016]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25339016]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@25339016]
Transaction synchronization resuming SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
2021-11-24 15:41:52 [main] INFO  j.c.m.b.d.s.DefaultDeadStockToolCreateService - DeadstockToolçÏê¨èàóùÇ™èIóπÇµÇ‹ÇµÇΩÅB
2021-11-24 15:41:52 [main] INFO  j.c.m.b.d.s.DefaultDeadStockToolCreateService - éÊìæåèêîÅF1åèÅAìoò^åèêî:3åè
Transaction synchronization committing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Transaction synchronization deregistering SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
Transaction synchronization closing SqlSession [org.apache.ibatis.session.defaults.DefaultSqlSession@4edca8be]
2021-11-24 15:41:52 [main] INFO  o.s.s.c.ThreadPoolTaskExecutor - Shutting down ExecutorService 'applicationTaskExecutor'
2021-11-24 15:41:52 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown initiated...
2021-11-24 15:41:52 [main] INFO  com.zaxxer.hikari.HikariDataSource - HikariPool-1 - Shutdown completed.
